# Experiment 1
# Evaluating efficacy of multi-token regularization
preambles:
  glong:   
    - "#!/bin/bash"
    - "#SBATCH --output=slurm/slurm-%j.out"
    - "#SBATCH --error=slurm/slurm-%j.err"   
    - "#SBATCH --partition=long"
    - "#SBATCH --gres=gpu:a100l:4"
    - "#SBATCH --mem=128G"
    - "#SBATCH --cpus-per-task=12"
    - "#SBATCH --nodes=1"
    - "source /home/mila/m/marawan.gamal/scratch/mtl/.venv/bin/activate"

group:
  name: "main"
  type: parallel
  jobs:
    - group:
        type: parallel
        jobs:
          - job:
              name: "none"
              preamble: glong
              command: "HF_HOME=$SCRATCH/huggingface python train_smol.py --model_head none"

          - job:
              name: "stp"
              preamble: glong
              command: "HF_HOME=$SCRATCH/huggingface python train_smol.py --model_head stp"

          - job:
              name: "multihead_r8_h2"
              preamble: glong
              command: "HF_HOME=$SCRATCH/huggingface python train_smol.py --model_head multihead --rank 8 --horizon 2"

          - job:
              name: "multihead_r1_h1"
              preamble: glong
              command: "HF_HOME=$SCRATCH/huggingface python train_smol.py --model_head multihead --rank 1 --horizon 1"